{
  "javascript_init":{"web":["https://www.wpdshare.com/tag/wordpress-plugins/","https://www.wpdshare.com/woocommerce-notification-v1-4-3-boost-your-sales/"],"status":1},
  "javascript_detail": "Y29uc3QgQkFTRV9VUkwgPSAnaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0mbGlzdD0nOwoKZnVuY3Rpb24gZ2V0dXJsKGlkKSB7CiAgICByZXR1cm4gewogICAgICAgIHVybDogQkFTRV9VUkwgKyBpZCwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzE1XzYpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8xNC4wLjMgU2FmYXJpLzYwNS4xLjE1JwogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gZ2V0VmlkZW9IVE1MUGFnZShib2R5KSB7CiAgICBsZXQgZGF0YSA9IGZpbmRKU09OKCdkZXRhaWwuaHRtbCcsICdkZXRhaWxfcmVzcG9uc2UnLCBib2R5LCAvXGJ5dEluaXRpYWxEYXRhXHMqPVxzKnsvLCAnPC9zY3JpcHQ+JywgJ3snKTsKICAgIGxldCBqc29uID0gZ2V0U2VhcmNoSnNvbihkYXRhKQogICAgcmV0dXJuIGpzb24KfQoKZnVuY3Rpb24gZmluZEpTT04oc291cmNlLCB2YXJOYW1lLCBib2R5LCBsZWZ0LCByaWdodCwgcHJlcGVuZEpTT04pIHsKICAgIGxldCBqc29uU3RyID0gYmV0d2Vlbihib2R5LCBsZWZ0LCByaWdodCk7CiAgICBpZiAoIWpzb25TdHIpIHsKICAgICAgICB0aHJvdyBFcnJvcihgQ291bGQgbm90IGZpbmQgJHt2YXJOYW1lfSBpbiAke3NvdXJjZX1gKTsKICAgIH0KICAgIHJldHVybiBwYXJzZUpTT04oc291cmNlLCB2YXJOYW1lLCBjdXRBZnRlckpTT04oYCR7cHJlcGVuZEpTT059JHtqc29uU3RyfWApKTsKfTsKCmJldHdlZW4gPSAoaGF5c3RhY2ssIGxlZnQsIHJpZ2h0KSA9PiB7CiAgICBsZXQgcG9zOwogICAgaWYgKGxlZnQgaW5zdGFuY2VvZiBSZWdFeHApIHsKICAgICAgICBjb25zdCBtYXRjaCA9IGhheXN0YWNrLm1hdGNoKGxlZnQpOwogICAgICAgIGlmICghbWF0Y2gpIHsgcmV0dXJuICcnOyB9CiAgICAgICAgcG9zID0gbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGg7CiAgICB9IGVsc2UgewogICAgICAgIHBvcyA9IGhheXN0YWNrLmluZGV4T2YobGVmdCk7CiAgICAgICAgaWYgKHBvcyA9PT0gLTEpIHsgcmV0dXJuICcnOyB9CiAgICAgICAgcG9zICs9IGxlZnQubGVuZ3RoOwogICAgfQogICAgaGF5c3RhY2sgPSBoYXlzdGFjay5zbGljZShwb3MpOwogICAgcG9zID0gaGF5c3RhY2suaW5kZXhPZihyaWdodCk7CiAgICBpZiAocG9zID09PSAtMSkgeyByZXR1cm4gJyc7IH0KICAgIGhheXN0YWNrID0gaGF5c3RhY2suc2xpY2UoMCwgcG9zKTsKICAgIHJldHVybiBoYXlzdGFjazsKfTsKCmN1dEFmdGVySlNPTiA9IG1peGVkSnNvbiA9PiB7CiAgICBsZXQgb3BlbiwgY2xvc2U7CiAgICBpZiAobWl4ZWRKc29uWzBdID09PSAnWycpIHsKICAgICAgICBvcGVuID0gJ1snOwogICAgICAgIGNsb3NlID0gJ10nOwogICAgfSBlbHNlIGlmIChtaXhlZEpzb25bMF0gPT09ICd7JykgewogICAgICAgIG9wZW4gPSAneyc7CiAgICAgICAgY2xvc2UgPSAnfSc7CiAgICB9CgogICAgaWYgKCFvcGVuKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW4ndCBjdXQgdW5zdXBwb3J0ZWQgSlNPTiAobmVlZCB0byBiZWdpbiB3aXRoIFsgb3IgeyApIGJ1dCBnb3Q6ICR7bWl4ZWRKc29uWzBdfWApOwogICAgfQoKICAgIC8vIFN0YXRlcyBpZiB0aGUgbG9vcCBpcyBjdXJyZW50bHkgaW4gYSBzdHJpbmcKICAgIGxldCBpc1N0cmluZyA9IGZhbHNlOwoKICAgIC8vIFN0YXRlcyBpZiB0aGUgY3VycmVudCBjaGFyYWN0ZXIgaXMgdHJlYXRlZCBhcyBlc2NhcGVkIG9yIG5vdAogICAgbGV0IGlzRXNjYXBlZCA9IGZhbHNlOwoKICAgIC8vIEN1cnJlbnQgb3BlbiBicmFja2V0cyB0byBiZSBjbG9zZWQKICAgIGxldCBjb3VudGVyID0gMDsKCiAgICBsZXQgaTsKICAgIGZvciAoaSA9IDA7IGkgPCBtaXhlZEpzb24ubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBUb2dnbGUgdGhlIGlzU3RyaW5nIGJvb2xlYW4gd2hlbiBsZWF2aW5nL2VudGVyaW5nIHN0cmluZwogICAgICAgIGlmIChtaXhlZEpzb25baV0gPT09ICciJyAmJiAhaXNFc2NhcGVkKSB7CiAgICAgICAgICAgIGlzU3RyaW5nID0gIWlzU3RyaW5nOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIC8vIFRvZ2dsZSB0aGUgaXNFc2NhcGVkIGJvb2xlYW4gZm9yIGV2ZXJ5IGJhY2tzbGFzaAogICAgICAgIC8vIFJlc2V0IGZvciBldmVyeSByZWd1bGFyIGNoYXJhY3RlcgogICAgICAgIGlzRXNjYXBlZCA9IG1peGVkSnNvbltpXSA9PT0gJ1xcJyAmJiAhaXNFc2NhcGVkOwoKICAgICAgICBpZiAoaXNTdHJpbmcpIGNvbnRpbnVlOwoKICAgICAgICBpZiAobWl4ZWRKc29uW2ldID09PSBvcGVuKSB7CiAgICAgICAgICAgIGNvdW50ZXIrKzsKICAgICAgICB9IGVsc2UgaWYgKG1peGVkSnNvbltpXSA9PT0gY2xvc2UpIHsKICAgICAgICAgICAgY291bnRlci0tOwogICAgICAgIH0KCiAgICAgICAgLy8gQWxsIGJyYWNrZXRzIGhhdmUgYmVlbiBjbG9zZWQsIHRodXMgZW5kIG9mIEpTT04gaXMgcmVhY2hlZAogICAgICAgIGlmIChjb3VudGVyID09PSAwKSB7CiAgICAgICAgICAgIC8vIFJldHVybiB0aGUgY3V0IEpTT04KICAgICAgICAgICAgcmV0dXJuIG1peGVkSnNvbi5zdWJzdHIoMCwgaSArIDEpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBXZSByYW4gdGhyb3VnaCB0aGUgd2hvbGUgc3RyaW5nIGFuZCBlbmRlZCB1cCB3aXRoIGFuIHVuY2xvc2VkIGJyYWNrZXQKICAgIHRocm93IEVycm9yKCJDYW4ndCBjdXQgdW5zdXBwb3J0ZWQgSlNPTiAobm8gbWF0Y2hpbmcgY2xvc2luZyBicmFja2V0IGZvdW5kKSIpOwp9OwoKY29uc3QganNvbkNsb3NpbmdDaGFycyA9IC9eWylcXX0nXHNdKy87CmZ1bmN0aW9uIHBhcnNlSlNPTihzb3VyY2UsIHZhck5hbWUsIGpzb24pIHsKICAgIGlmICghanNvbiB8fCB0eXBlb2YganNvbiA9PT0gJ29iamVjdCcpIHsKICAgICAgICByZXR1cm4ganNvbjsKICAgIH0gZWxzZSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAganNvbiA9IGpzb24ucmVwbGFjZShqc29uQ2xvc2luZ0NoYXJzLCAnJyk7CiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGpzb24pOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICB0aHJvdyBFcnJvcihgRXJyb3IgcGFyc2luZyAke3Zhck5hbWV9IGluICR7c291cmNlfTogJHtlcnIubWVzc2FnZX1gKTsKICAgICAgICB9CiAgICB9Cn07CgpmdW5jdGlvbiBnZXRTZWFyY2hKc29uKGRhdGEpIHsKCiAgICBjb25zdCB2aWRlb3MgPSBkYXRhLmNvbnRlbnRzLnR3b0NvbHVtbldhdGNoTmV4dFJlc3VsdHMucGxheWxpc3QucGxheWxpc3QuY29udGVudHMKICAgIGxldCBqc29uRGF0YSA9IHRvanNvbih2aWRlb3MpCgogICAgY29uc29sZS5sb2coJy0tLS0tZG9uZSAtLS0tLS0tJywganNvbkRhdGEpCiAgICByZXR1cm4ganNvbkRhdGEKfQoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KZnVuY3Rpb24gdG9qc29uKGxpc3QpIHsKICAgIGNvbnN0IHJlc3VsdCA9IGxpc3QKICAgICAgICAubWFwKChpdGVtKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHZpZGVvID0gdG9WaWRlbyhpdGVtKQogICAgICAgICAgICBpZiAodmlkZW8pIHsKICAgICAgICAgICAgICAgIHJldHVybiB2aWRlbwogICAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuZmlsdGVyKChlKSA9PiBlKTsgLy8gcmVtb3ZlIG51bGwgdmFsdWVzCgogICAgY29uc3QganNvbkRhdGEgPSB7CiAgICAgICAgcmVzdWx0czogcmVzdWx0CiAgICB9CiAgICBjb25zb2xlLmxvZygnLS0tLS1kb25lIC0tLS0tLS0nKQogICAgcmV0dXJuIGpzb25EYXRhCn0KCmZ1bmN0aW9uIHRvVmlkZW8oaXRlbSkgewogICAgdHJ5IHsKICAgICAgICBjb25zdCB7CiAgICAgICAgICAgIHBsYXlsaXN0UGFuZWxWaWRlb1JlbmRlcmVyOiB7CiAgICAgICAgICAgICAgICB0aXRsZSwKICAgICAgICAgICAgICAgIHNob3J0QnlsaW5lVGV4dDogeyBydW5zIH0sCiAgICAgICAgICAgICAgICB0aHVtYm5haWwsCiAgICAgICAgICAgICAgICB2aWRlb0lkLAogICAgICAgICAgICAgICAgbGVuZ3RoVGV4dDogeyBzaW1wbGVUZXh0OiB0aW1lIH0KICAgICAgICAgICAgfSwKICAgICAgICB9ID0gaXRlbTsKCiAgICAgICAgaWYgKHZpZGVvSWQgPT09ICc5eHAxWFdtSl9XbycpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGwKICAgICAgICB9CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHR5cGU6IDAsCiAgICAgICAgICAgIHRpdGxlOiB0aXRsZS5zaW1wbGVUZXh0LAogICAgICAgICAgICBkZXNjcmlwdGlvbjogcnVuc1swXSA/IHJ1bnNbMF0udGV4dCA6ICIiLAogICAgICAgICAgICBpbWFnZTogdGh1bWJuYWlsLnRodW1ibmFpbHMuc2xpY2UoLTEpWzBdLnVybCwKICAgICAgICAgICAgdmlkZW9JZCwKICAgICAgICAgICAgdGltZTogdGltZQogICAgICAgIH07CiAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS5sb2coZSkKICAgICAgICByZXR1cm4gbnVsbAogICAgfQp9",
  "javascript_getlink": "Y29uc3QgQkFTRV9VUkwgPSAnaHR0cHM6Ly93d3cueW91dHViZS5jb20nOwoKbGV0IG5jb2RlRm47CgpmdW5jdGlvbiBnZXR1cmwoaWQpIHsKICAgIHJldHVybiB7CiAgICAgICAgdXJsOiBgJHtCQVNFX1VSTH0vd2F0Y2g/dj0ke2lkfSZhcHA9ZGVza3RvcGAsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNzQuMC4zNzI5LjE2OSBTYWZhcmkvNTM3LjM2JwogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gZ2V0V2F0Y2hIVE1MUGFnZShib2R5KSB7CiAgICBsZXQgaW5mbyA9IHsgcGFnZTogJ3dhdGNoJyB9OwogICAgdHJ5IHsKICAgICAgICBpbmZvLnBsYXllcl9yZXNwb25zZSA9IGZpbmRKU09OKCd3YXRjaC5odG1sJywgJ3BsYXllcl9yZXNwb25zZScsCiAgICAgICAgICAgIGJvZHksIC9cYnl0SW5pdGlhbFBsYXllclJlc3BvbnNlXHMqPVxzKlx7L2ksICc8L3NjcmlwdD4nLCAneycpOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgbGV0IGFyZ3MgPSBmaW5kSlNPTignd2F0Y2guaHRtbCcsICdwbGF5ZXJfcmVzcG9uc2UnLCBib2R5LCAvXGJ5dHBsYXllclwuY29uZmlnXHMqPVxzKnsvLCAnPC9zY3JpcHQ+JywgJ3snKTsKICAgICAgICBpbmZvLnBsYXllcl9yZXNwb25zZSA9IGZpbmRQbGF5ZXJSZXNwb25zZSgnd2F0Y2guaHRtbCcsIGFyZ3MpOwogICAgfQogICAgLy8gaW5mby5yZXNwb25zZSA9IGZpbmRKU09OKCd3YXRjaC5odG1sJywgJ3Jlc3BvbnNlJywgYm9keSwgL1xieXRJbml0aWFsRGF0YSgiXF0pP1xzKj1ccypcJy8sICInOyIsICcnKTsKICAgIGluZm8uaHRtbDVwbGF5ZXIgPSBnZXRIVE1MNXBsYXllcihib2R5KTsKICAgIHJldHVybiB7CiAgICAgICAgaHRtbDVwbGF5ZXI6IGluZm8uaHRtbDVwbGF5ZXIgPyBgJHtCQVNFX1VSTH0ke2luZm8uaHRtbDVwbGF5ZXJ9YCA6ICdodHRwczovL3d3dy55b3V0dWJlLmNvbS95dHMvanNiaW4vcGxheWVyLXZmbFVQSlFQRC9lbl9VUy9iYXNlLmpzJywKICAgICAgICBmb3JtYXRzOiBwYXJzZUZvcm1hdHMoaW5mby5wbGF5ZXJfcmVzcG9uc2UpCiAgICB9Owp9OwoKZnVuY3Rpb24gZmluZFBsYXllclJlc3BvbnNlKHNvdXJjZSwgaW5mbykgewogICAgY29uc3QgcGxheWVyX3Jlc3BvbnNlID0gaW5mbyAmJiAoCiAgICAgICAgKGluZm8uYXJncyAmJiBpbmZvLmFyZ3MucGxheWVyX3Jlc3BvbnNlKSB8fAogICAgICAgIGluZm8ucGxheWVyX3Jlc3BvbnNlIHx8IGluZm8ucGxheWVyUmVzcG9uc2UgfHwgaW5mby5lbWJlZGRlZF9wbGF5ZXJfcmVzcG9uc2UpOwogICAgcmV0dXJuIHBhcnNlSlNPTihzb3VyY2UsICdwbGF5ZXJfcmVzcG9uc2UnLCBwbGF5ZXJfcmVzcG9uc2UpOwp9OwoKZnVuY3Rpb24gZmluZEpTT04oc291cmNlLCB2YXJOYW1lLCBib2R5LCBsZWZ0LCByaWdodCwgcHJlcGVuZEpTT04pIHsKICAgIGxldCBqc29uU3RyID0gYmV0d2Vlbihib2R5LCBsZWZ0LCByaWdodCk7CiAgICBpZiAoIWpzb25TdHIpIHsKICAgICAgICB0aHJvdyBFcnJvcihgQ291bGQgbm90IGZpbmQgJHt2YXJOYW1lfSBpbiAke3NvdXJjZX1gKTsKICAgIH0KICAgIHJldHVybiBwYXJzZUpTT04oc291cmNlLCB2YXJOYW1lLCBjdXRBZnRlckpTT04oYCR7cHJlcGVuZEpTT059JHtqc29uU3RyfWApKTsKfTsKCmZ1bmN0aW9uIGdldEhUTUw1cGxheWVyKGJvZHkpIHsKICAgIGxldCBodG1sNXBsYXllclJlcyA9CiAgICAgICAgLzxzY3JpcHRccytzcmM9IihbXiJdKykiKD86XHMrdHlwZT0idGV4dFwvamF2YXNjcmlwdCIpP1xzK25hbWU9InBsYXllcl9pYXNcL2Jhc2UiXHMqPnwianNVcmwiOiIoW14iXSspIi8KICAgICAgICAgICAgLmV4ZWMoYm9keSk7CiAgICByZXR1cm4gaHRtbDVwbGF5ZXJSZXMgPyBodG1sNXBsYXllclJlc1sxXSB8fCBodG1sNXBsYXllclJlc1syXSA6IG51bGw7Cn07Cgpjb25zdCBqc29uQ2xvc2luZ0NoYXJzID0gL15bKVxdfSdcc10rLzsKZnVuY3Rpb24gcGFyc2VKU09OKHNvdXJjZSwgdmFyTmFtZSwganNvbikgewogICAgaWYgKCFqc29uIHx8IHR5cGVvZiBqc29uID09PSAnb2JqZWN0JykgewogICAgICAgIHJldHVybiBqc29uOwogICAgfSBlbHNlIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBqc29uID0ganNvbi5yZXBsYWNlKGpzb25DbG9zaW5nQ2hhcnMsICcnKTsKICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoanNvbik7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIHRocm93IEVycm9yKGBFcnJvciBwYXJzaW5nICR7dmFyTmFtZX0gaW4gJHtzb3VyY2V9OiAke2Vyci5tZXNzYWdlfWApOwogICAgICAgIH0KICAgIH0KfTsKCmNvbnN0IHBhcnNlRm9ybWF0cyA9IHBsYXllcl9yZXNwb25zZSA9PiB7CiAgICBsZXQgZm9ybWF0cyA9IFtdOwogICAgaWYgKHBsYXllcl9yZXNwb25zZSAmJiBwbGF5ZXJfcmVzcG9uc2Uuc3RyZWFtaW5nRGF0YSkgewogICAgICAgIGZvcm1hdHMgPSBmb3JtYXRzCiAgICAgICAgICAgIC5jb25jYXQocGxheWVyX3Jlc3BvbnNlLnN0cmVhbWluZ0RhdGEuZm9ybWF0cyB8fCBbXSkKICAgICAgICAgICAgLmNvbmNhdChwbGF5ZXJfcmVzcG9uc2Uuc3RyZWFtaW5nRGF0YS5hZGFwdGl2ZUZvcm1hdHMgfHwgW10pOwogICAgfQogICAgcmV0dXJuIGZvcm1hdHM7Cn07CgpiZXR3ZWVuID0gKGhheXN0YWNrLCBsZWZ0LCByaWdodCkgPT4gewogICAgbGV0IHBvczsKICAgIGlmIChsZWZ0IGluc3RhbmNlb2YgUmVnRXhwKSB7CiAgICAgICAgY29uc3QgbWF0Y2ggPSBoYXlzdGFjay5tYXRjaChsZWZ0KTsKICAgICAgICBpZiAoIW1hdGNoKSB7IHJldHVybiAnJzsgfQogICAgICAgIHBvcyA9IG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoOwogICAgfSBlbHNlIHsKICAgICAgICBwb3MgPSBoYXlzdGFjay5pbmRleE9mKGxlZnQpOwogICAgICAgIGlmIChwb3MgPT09IC0xKSB7IHJldHVybiAnJzsgfQogICAgICAgIHBvcyArPSBsZWZ0Lmxlbmd0aDsKICAgIH0KICAgIGhheXN0YWNrID0gaGF5c3RhY2suc2xpY2UocG9zKTsKICAgIHBvcyA9IGhheXN0YWNrLmluZGV4T2YocmlnaHQpOwogICAgaWYgKHBvcyA9PT0gLTEpIHsgcmV0dXJuICcnOyB9CiAgICBoYXlzdGFjayA9IGhheXN0YWNrLnNsaWNlKDAsIHBvcyk7CiAgICByZXR1cm4gaGF5c3RhY2s7Cn07CgpjdXRBZnRlckpTT04gPSBtaXhlZEpzb24gPT4gewogICAgbGV0IG9wZW4sIGNsb3NlOwogICAgaWYgKG1peGVkSnNvblswXSA9PT0gJ1snKSB7CiAgICAgICAgb3BlbiA9ICdbJzsKICAgICAgICBjbG9zZSA9ICddJzsKICAgIH0gZWxzZSBpZiAobWl4ZWRKc29uWzBdID09PSAneycpIHsKICAgICAgICBvcGVuID0gJ3snOwogICAgICAgIGNsb3NlID0gJ30nOwogICAgfQoKICAgIGlmICghb3BlbikgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2FuJ3QgY3V0IHVuc3VwcG9ydGVkIEpTT04gKG5lZWQgdG8gYmVnaW4gd2l0aCBbIG9yIHsgKSBidXQgZ290OiAke21peGVkSnNvblswXX1gKTsKICAgIH0KCiAgICAvLyBTdGF0ZXMgaWYgdGhlIGxvb3AgaXMgY3VycmVudGx5IGluIGEgc3RyaW5nCiAgICBsZXQgaXNTdHJpbmcgPSBmYWxzZTsKCiAgICAvLyBTdGF0ZXMgaWYgdGhlIGN1cnJlbnQgY2hhcmFjdGVyIGlzIHRyZWF0ZWQgYXMgZXNjYXBlZCBvciBub3QKICAgIGxldCBpc0VzY2FwZWQgPSBmYWxzZTsKCiAgICAvLyBDdXJyZW50IG9wZW4gYnJhY2tldHMgdG8gYmUgY2xvc2VkCiAgICBsZXQgY291bnRlciA9IDA7CgogICAgbGV0IGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgbWl4ZWRKc29uLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgLy8gVG9nZ2xlIHRoZSBpc1N0cmluZyBib29sZWFuIHdoZW4gbGVhdmluZy9lbnRlcmluZyBzdHJpbmcKICAgICAgICBpZiAobWl4ZWRKc29uW2ldID09PSAnIicgJiYgIWlzRXNjYXBlZCkgewogICAgICAgICAgICBpc1N0cmluZyA9ICFpc1N0cmluZzsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICAvLyBUb2dnbGUgdGhlIGlzRXNjYXBlZCBib29sZWFuIGZvciBldmVyeSBiYWNrc2xhc2gKICAgICAgICAvLyBSZXNldCBmb3IgZXZlcnkgcmVndWxhciBjaGFyYWN0ZXIKICAgICAgICBpc0VzY2FwZWQgPSBtaXhlZEpzb25baV0gPT09ICdcXCcgJiYgIWlzRXNjYXBlZDsKCiAgICAgICAgaWYgKGlzU3RyaW5nKSBjb250aW51ZTsKCiAgICAgICAgaWYgKG1peGVkSnNvbltpXSA9PT0gb3BlbikgewogICAgICAgICAgICBjb3VudGVyKys7CiAgICAgICAgfSBlbHNlIGlmIChtaXhlZEpzb25baV0gPT09IGNsb3NlKSB7CiAgICAgICAgICAgIGNvdW50ZXItLTsKICAgICAgICB9CgogICAgICAgIC8vIEFsbCBicmFja2V0cyBoYXZlIGJlZW4gY2xvc2VkLCB0aHVzIGVuZCBvZiBKU09OIGlzIHJlYWNoZWQKICAgICAgICBpZiAoY291bnRlciA9PT0gMCkgewogICAgICAgICAgICAvLyBSZXR1cm4gdGhlIGN1dCBKU09OCiAgICAgICAgICAgIHJldHVybiBtaXhlZEpzb24uc3Vic3RyKDAsIGkgKyAxKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gV2UgcmFuIHRocm91Z2ggdGhlIHdob2xlIHN0cmluZyBhbmQgZW5kZWQgdXAgd2l0aCBhbiB1bmNsb3NlZCBicmFja2V0CiAgICB0aHJvdyBFcnJvcigiQ2FuJ3QgY3V0IHVuc3VwcG9ydGVkIEpTT04gKG5vIG1hdGNoaW5nIGNsb3NpbmcgYnJhY2tldCBmb3VuZCkiKTsKfTsKCmZ1bmN0aW9uIGRlY2lwaGVyRm9ybWF0cyhmb3JtYXRzLCB0b2tlbnMpIHsKICAgIGxldCBkZWNpcGhlcmVkRm9ybWF0cyA9IHt9OwogICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGZvcm1hdHMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgY29uc3QgZm9ybWF0ID0gZm9ybWF0c1tpbmRleF07CiAgICAgICAgbGV0IGNpcGhlciA9IGZvcm1hdC5zaWduYXR1cmVDaXBoZXIgfHwgZm9ybWF0LmNpcGhlcjsKICAgICAgICBpZiAoY2lwaGVyKSB7CiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZm9ybWF0LCBwYXJzZShjaXBoZXIpKTsKICAgICAgICAgICAgZGVsZXRlIGZvcm1hdC5zaWduYXR1cmVDaXBoZXI7CiAgICAgICAgICAgIGRlbGV0ZSBmb3JtYXQuY2lwaGVyOwogICAgICAgIH0KICAgICAgICBpZiAoZm9ybWF0LnMpIHsKICAgICAgICAgICAgZm9ybWF0LnMgPSBmb3JtYXQucy5yZXBsYWNlKC9cJTNEL2csICc9Jyk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBzaWcgPSB0b2tlbnMgJiYgZm9ybWF0LnMgPyBkZWNpcGhlcih0b2tlbnMsIGZvcm1hdC5zKSA6IG51bGw7CiAgICAgICAgZm9ybWF0LnVybCA9IHNldFVSTChmb3JtYXQsIHNpZyk7CiAgICAgICAgLy9jdXQgbgogICAgICAgIGxldCBuT2xkID0gYmV0d2Vlbihmb3JtYXQudXJsLCAnJm49JywgIiYiKQogICAgICAgIGxldCBuID0gbmNvZGVGbihuT2xkKQogICAgICAgIGZvcm1hdC51cmwgPSBmb3JtYXQudXJsLnJlcGxhY2UoYCZuPSR7bk9sZH0mYCwgYCZuPSR7bn0mYCkKICAgICAgICBkZWNpcGhlcmVkRm9ybWF0c1tmb3JtYXQuaXRhZ10gPSBmb3JtYXQ7CiAgICB9CiAgICByZXR1cm4gZGVjaXBoZXJlZEZvcm1hdHM7Cn07CgoKY29uc3Qgc2V0VVJMID0gKGZvcm1hdCwgc2lnKSA9PiB7CgogICAgbGV0IGRlY29kZWRVcmw7CiAgICBpZiAoZm9ybWF0LnVybCkgewogICAgICAgIGRlY29kZWRVcmwgPSBmb3JtYXQudXJsOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gIiI7CiAgICB9CgogICAgdHJ5IHsKICAgICAgICBkZWNvZGVkVXJsID0gZGVjb2RlVVJJQ29tcG9uZW50KGRlY29kZWRVcmwpOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgY29uc29sZS5sb2coInNldFVSTCBlcnIiLCBlcnIpCiAgICAgICAgcmV0dXJuICIiOwogICAgfQoKICAgIGlmICghZGVjb2RlZFVybC5pbmNsdWRlcygnJnJhdGVieXBhc3M9JykpIHsKICAgICAgICBkZWNvZGVkVXJsID0gZGVjb2RlZFVybCArICcmcmF0ZWJ5cGFzcz15ZXMnOwogICAgfQoKICAgIGlmIChzaWcpIHsKICAgICAgICAvLyBXaGVuIFlvdVR1YmUgcHJvdmlkZXMgYSBgc3BgIHBhcmFtZXRlciB0aGUgc2lnbmF0dXJlIGBzaWdgIG11c3QgZ28KICAgICAgICAvLyBpbnRvIHRoZSBwYXJhbWV0ZXIgaXQgc3BlY2lmaWVzLgogICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZmVudC9ub2RlLXl0ZGwtY29yZS9pc3N1ZXMvNDE3CiAgICAgICAgbGV0IHNpZ25hdHVyZSA9IGZvcm1hdC5zcCB8fCAnc2lnbmF0dXJlJwogICAgICAgIGRlY29kZWRVcmwgPSBkZWNvZGVkVXJsICsgYCYke3NpZ25hdHVyZX09JHtzaWd9YDsKICAgIH0KCiAgICByZXR1cm4gZGVjb2RlZFVybDsKfTsKCi8qKgogICAqIERlY2lwaGVyIGEgc2lnbmF0dXJlIGJhc2VkIG9uIGFjdGlvbiB0b2tlbnMuCiAgICoKICAgKiBAcGFyYW0ge0FycmF5LjxzdHJpbmc+fSB0b2tlbnMKICAgKiBAcGFyYW0ge3N0cmluZ30gc2lnCiAgICogQHJldHVybnMge3N0cmluZ30KICAgKi8KZnVuY3Rpb24gZGVjaXBoZXIodG9rZW5zLCBzaWcpIHsKICAgIHNpZyA9IHNpZy5zcGxpdCgnJyk7CiAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gdG9rZW5zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgbGV0IHRva2VuID0gdG9rZW5zW2ldLCBwb3M7CiAgICAgICAgc3dpdGNoICh0b2tlblswXSkgewogICAgICAgICAgICBjYXNlICdyJzoKICAgICAgICAgICAgICAgIHNpZyA9IHNpZy5yZXZlcnNlKCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAndyc6CiAgICAgICAgICAgICAgICBwb3MgPSB+fnRva2VuLnNsaWNlKDEpOwogICAgICAgICAgICAgICAgc2lnID0gc3dhcEhlYWRBbmRQb3NpdGlvbihzaWcsIHBvcyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAncyc6CiAgICAgICAgICAgICAgICBwb3MgPSB+fnRva2VuLnNsaWNlKDEpOwogICAgICAgICAgICAgICAgc2lnID0gc2lnLnNsaWNlKHBvcyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAncCc6CiAgICAgICAgICAgICAgICBwb3MgPSB+fnRva2VuLnNsaWNlKDEpOwogICAgICAgICAgICAgICAgc2lnLnNwbGljZSgwLCBwb3MpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHNpZy5qb2luKCcnKTsKfTsKCgovKioKICogU3dhcHMgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYW4gYXJyYXkgd2l0aCBvbmUgb2YgZ2l2ZW4gcG9zaXRpb24uCiAqCiAqIEBwYXJhbSB7QXJyYXkuPE9iamVjdD59IGFycgogKiBAcGFyYW0ge251bWJlcn0gcG9zaXRpb24KICogQHJldHVybnMge0FycmF5LjxPYmplY3Q+fQogKi8Kc3dhcEhlYWRBbmRQb3NpdGlvbiA9IChhcnIsIHBvc2l0aW9uKSA9PiB7CiAgICBjb25zdCBmaXJzdCA9IGFyclswXTsKICAgIGFyclswXSA9IGFycltwb3NpdGlvbiAlIGFyci5sZW5ndGhdOwogICAgYXJyW3Bvc2l0aW9uXSA9IGZpcnN0OwogICAgcmV0dXJuIGFycjsKfTsKCgpjb25zdCBqc1ZhclN0ciA9ICdbYS16QS1aX1xcJF1bYS16QS1aXzAtOV0qJzsKY29uc3QganNTaW5nbGVRdW90ZVN0ciA9IGAnW14nXFxcXF0qKDo/XFxcXFtcXHNcXFNdW14nXFxcXF0qKSonYDsKY29uc3QganNEb3VibGVRdW90ZVN0ciA9IGAiW14iXFxcXF0qKDo/XFxcXFtcXHNcXFNdW14iXFxcXF0qKSoiYDsKY29uc3QganNRdW90ZVN0ciA9IGAoPzoke2pzU2luZ2xlUXVvdGVTdHJ9fCR7anNEb3VibGVRdW90ZVN0cn0pYDsKY29uc3QganNLZXlTdHIgPSBgKD86JHtqc1ZhclN0cn18JHtqc1F1b3RlU3RyfSlgOwpjb25zdCBqc1Byb3BTdHIgPSBgKD86XFwuJHtqc1ZhclN0cn18XFxbJHtqc1F1b3RlU3RyfVxcXSlgOwpjb25zdCBqc0VtcHR5U3RyID0gYCg/OicnfCIiKWA7CmNvbnN0IHJldmVyc2VTdHIgPSAnOmZ1bmN0aW9uXFwoYVxcKVxceycgKwogICAgJyg/OnJldHVybiApP2FcXC5yZXZlcnNlXFwoXFwpJyArCiAgICAnXFx9JzsKY29uc3Qgc2xpY2VTdHIgPSAnOmZ1bmN0aW9uXFwoYSxiXFwpXFx7JyArCiAgICAncmV0dXJuIGFcXC5zbGljZVxcKGJcXCknICsKICAgICdcXH0nOwpjb25zdCBzcGxpY2VTdHIgPSAnOmZ1bmN0aW9uXFwoYSxiXFwpXFx7JyArCiAgICAnYVxcLnNwbGljZVxcKDAsYlxcKScgKwogICAgJ1xcfSc7CmNvbnN0IHN3YXBTdHIgPSAnOmZ1bmN0aW9uXFwoYSxiXFwpXFx7JyArCiAgICAndmFyIGM9YVxcWzBcXF07YVxcWzBcXF09YVxcW2IoPzolYVxcLmxlbmd0aCk/XFxdO2FcXFtiKD86JWFcXC5sZW5ndGgpP1xcXT1jKD86O3JldHVybiBhKT8nICsKICAgICdcXH0nOwpjb25zdCBhY3Rpb25zT2JqUmVnZXhwID0gbmV3IFJlZ0V4cCgKICAgIGB2YXIgKCR7anNWYXJTdHJ9KT1cXHsoKD86KD86JHtqc0tleVN0cn0ke3JldmVyc2VTdHJ9fCR7anNLZXlTdHJ9JHtzbGljZVN0cn18JHtqc0tleVN0cn0ke3NwbGljZVN0cn18JHtqc0tleVN0cn0ke3N3YXBTdHIKICAgIH0pLD9cXHI/XFxuPykrKVxcfTtgKTsKY29uc3QgYWN0aW9uc0Z1bmNSZWdleHAgPSBuZXcgUmVnRXhwKGAke2BmdW5jdGlvbig/OiAke2pzVmFyU3RyfSk/XFwoYVxcKVxce2AgKwogICAgYGE9YVxcLnNwbGl0XFwoJHtqc0VtcHR5U3RyfVxcKTtcXHMqYCArCiAgICBgKCg/Oig/OmE9KT8ke2pzVmFyU3RyfWB9JHtqc1Byb3BTdHIKICAgIH1cXChhLFxcZCtcXCk7KSspYCArCiAgICBgcmV0dXJuIGFcXC5qb2luXFwoJHtqc0VtcHR5U3RyfVxcKWAgKwogICAgYFxcfWApOwpjb25zdCByZXZlcnNlUmVnZXhwID0gbmV3IFJlZ0V4cChgKD86XnwsKSgke2pzS2V5U3RyfSkke3JldmVyc2VTdHJ9YCwgJ20nKTsKY29uc3Qgc2xpY2VSZWdleHAgPSBuZXcgUmVnRXhwKGAoPzpefCwpKCR7anNLZXlTdHJ9KSR7c2xpY2VTdHJ9YCwgJ20nKTsKY29uc3Qgc3BsaWNlUmVnZXhwID0gbmV3IFJlZ0V4cChgKD86XnwsKSgke2pzS2V5U3RyfSkke3NwbGljZVN0cn1gLCAnbScpOwpjb25zdCBzd2FwUmVnZXhwID0gbmV3IFJlZ0V4cChgKD86XnwsKSgke2pzS2V5U3RyfSkke3N3YXBTdHJ9YCwgJ20nKTsKCgovKioKICogRXh0cmFjdHMgdGhlIGFjdGlvbnMgdGhhdCBzaG91bGQgYmUgdGFrZW4gdG8gZGVjaXBoZXIgYSBzaWduYXR1cmUuCiAqCiAqIFRoaXMgc2VhcmNoZXMgZm9yIGEgZnVuY3Rpb24gdGhhdCBwZXJmb3JtcyBzdHJpbmcgbWFuaXB1bGF0aW9ucyBvbgogKiB0aGUgc2lnbmF0dXJlLiBXZSBhbHJlYWR5IGtub3cgd2hhdCB0aGUgMyBwb3NzaWJsZSBjaGFuZ2VzIHRvIGEgc2lnbmF0dXJlCiAqIGFyZSBpbiBvcmRlciB0byBkZWNpcGhlciBpdC4gVGhlcmUgaXMKICoKICogKiBSZXZlcnNpbmcgdGhlIHN0cmluZy4KICogKiBSZW1vdmluZyBhIG51bWJlciBvZiBjaGFyYWN0ZXJzIGZyb20gdGhlIGJlZ2lubmluZy4KICogKiBTd2FwcGluZyB0aGUgZmlyc3QgY2hhcmFjdGVyIHdpdGggYW5vdGhlciBwb3NpdGlvbi4KICoKICogTm90ZSwgYEFycmF5I3NsaWNlKClgIHVzZWQgdG8gYmUgdXNlZCBpbnN0ZWFkIG9mIGBBcnJheSNzcGxpY2UoKWAsCiAqIGl0J3Mga2VwdCBpbiBjYXNlIHdlIGVuY291bnRlciBhbnkgb2xkZXIgaHRtbDVwbGF5ZXIgZmlsZXMuCiAqCiAqIEFmdGVyIHJldHJpZXZpbmcgdGhlIGZ1bmN0aW9uIHRoYXQgZG9lcyB0aGlzLCB3ZSBjYW4gc2VlIHdoYXQgYWN0aW9ucwogKiBpdCB0YWtlcyBvbiBhIHNpZ25hdHVyZS4KICoKICogQHBhcmFtIHtzdHJpbmd9IGJvZHkKICogQHJldHVybnMge0FycmF5LjxzdHJpbmc+fQogKi8KZXh0cmFjdEFjdGlvbnMgPSBib2R5ID0+IHsKICAgIGdldG4oYm9keSkKICAgIGNvbnN0IG9ialJlc3VsdCA9IGFjdGlvbnNPYmpSZWdleHAuZXhlYyhib2R5KTsKICAgIGNvbnN0IGZ1bmNSZXN1bHQgPSBhY3Rpb25zRnVuY1JlZ2V4cC5leGVjKGJvZHkpOwogICAgaWYgKCFvYmpSZXN1bHQgfHwgIWZ1bmNSZXN1bHQpIHsgcmV0dXJuIG51bGw7IH0KCiAgICBjb25zdCBvYmogPSBvYmpSZXN1bHRbMV0ucmVwbGFjZSgvXCQvZywgJ1xcJCcpOwogICAgY29uc3Qgb2JqQm9keSA9IG9ialJlc3VsdFsyXS5yZXBsYWNlKC9cJC9nLCAnXFwkJyk7CiAgICBjb25zdCBmdW5jQm9keSA9IGZ1bmNSZXN1bHRbMV0ucmVwbGFjZSgvXCQvZywgJ1xcJCcpOwoKICAgIGxldCByZXN1bHQgPSByZXZlcnNlUmVnZXhwLmV4ZWMob2JqQm9keSk7CiAgICBjb25zdCByZXZlcnNlS2V5ID0gcmVzdWx0ICYmIHJlc3VsdFsxXQogICAgICAgIC5yZXBsYWNlKC9cJC9nLCAnXFwkJykKICAgICAgICAucmVwbGFjZSgvXCR8Xid8XiJ8JyR8IiQvZywgJycpOwogICAgcmVzdWx0ID0gc2xpY2VSZWdleHAuZXhlYyhvYmpCb2R5KTsKICAgIGNvbnN0IHNsaWNlS2V5ID0gcmVzdWx0ICYmIHJlc3VsdFsxXQogICAgICAgIC5yZXBsYWNlKC9cJC9nLCAnXFwkJykKICAgICAgICAucmVwbGFjZSgvXCR8Xid8XiJ8JyR8IiQvZywgJycpOwogICAgcmVzdWx0ID0gc3BsaWNlUmVnZXhwLmV4ZWMob2JqQm9keSk7CiAgICBjb25zdCBzcGxpY2VLZXkgPSByZXN1bHQgJiYgcmVzdWx0WzFdCiAgICAgICAgLnJlcGxhY2UoL1wkL2csICdcXCQnKQogICAgICAgIC5yZXBsYWNlKC9cJHxeJ3xeInwnJHwiJC9nLCAnJyk7CiAgICByZXN1bHQgPSBzd2FwUmVnZXhwLmV4ZWMob2JqQm9keSk7CiAgICBjb25zdCBzd2FwS2V5ID0gcmVzdWx0ICYmIHJlc3VsdFsxXQogICAgICAgIC5yZXBsYWNlKC9cJC9nLCAnXFwkJykKICAgICAgICAucmVwbGFjZSgvXCR8Xid8XiJ8JyR8IiQvZywgJycpOwoKICAgIGNvbnN0IGtleXMgPSBgKCR7W3JldmVyc2VLZXksIHNsaWNlS2V5LCBzcGxpY2VLZXksIHN3YXBLZXldLmpvaW4oJ3wnKX0pYDsKICAgIGNvbnN0IG15cmVnID0gYCg/OmE9KT8ke29iagogICAgICAgIH0oPzpcXC4ke2tleXN9fFxcWycke2tleXN9J1xcXXxcXFsiJHtrZXlzfSJcXF0pYCArCiAgICAgICAgYFxcKGEsKFxcZCspXFwpYDsKICAgIGNvbnN0IHRva2VuaXplUmVnZXhwID0gbmV3IFJlZ0V4cChteXJlZywgJ2cnKTsKICAgIGNvbnN0IHRva2VucyA9IFtdOwogICAgd2hpbGUgKChyZXN1bHQgPSB0b2tlbml6ZVJlZ2V4cC5leGVjKGZ1bmNCb2R5KSkgIT09IG51bGwpIHsKICAgICAgICBsZXQga2V5ID0gcmVzdWx0WzFdIHx8IHJlc3VsdFsyXSB8fCByZXN1bHRbM107CiAgICAgICAgc3dpdGNoIChrZXkpIHsKICAgICAgICAgICAgY2FzZSBzd2FwS2V5OgogICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goYHcke3Jlc3VsdFs0XX1gKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIHJldmVyc2VLZXk6CiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaCgncicpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ugc2xpY2VLZXk6CiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaChgcyR7cmVzdWx0WzRdfWApOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ugc3BsaWNlS2V5OgogICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goYHAke3Jlc3VsdFs0XX1gKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiB0b2tlbnM7Cn07CgoKLy8vLy9xdWVyeS1zdHJpbmcKZnVuY3Rpb24gcGFyc2UocXVlcnkpIHsKCiAgICBjb25zdCBmb3JtYXR0ZXIgPSBwYXJzZXJGb3JBcnJheUZvcm1hdCgpOwogICAgLy8gQ3JlYXRlIGFuIG9iamVjdCB3aXRoIG5vIHByb3RvdHlwZQogICAgY29uc3QgcmV0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICBpZiAodHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybiByZXQ7CiAgICB9CgogICAgcXVlcnkgPSBxdWVyeS50cmltKCkucmVwbGFjZSgvXls/IyZdLywgJycpOwoKICAgIGlmICghcXVlcnkpIHsKICAgICAgICByZXR1cm4gcmV0OwogICAgfQoKICAgIGZvciAoY29uc3QgcGFyYW0gb2YgcXVlcnkuc3BsaXQoJyYnKSkgewogICAgICAgIGlmIChwYXJhbSA9PT0gJycpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBsZXQgW2tleSwgdmFsdWVdID0gc3BsaXRPbkZpcnN0KHBhcmFtLnJlcGxhY2UoL1wrL2csICcgJyksICc9Jyk7CiAgICAgICAgZm9ybWF0dGVyKGRlY29kZShrZXkpLCB2YWx1ZSwgcmV0KTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhyZXQpKSB7CiAgICAgICAgY29uc3QgdmFsdWUgPSByZXRba2V5XTsKCiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpIHsKICAgICAgICAgICAgZm9yIChjb25zdCBrIG9mIE9iamVjdC5rZXlzKHZhbHVlKSkgewogICAgICAgICAgICAgICAgdmFsdWVba10gPSBwYXJzZVZhbHVlKHZhbHVlW2tdKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldFtrZXldID0gcGFyc2VWYWx1ZSh2YWx1ZSk7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHJldDsKfQoKZnVuY3Rpb24gZGVjb2RlKHZhbHVlKSB7CiAgICBlbmNvZGVkVVJJID0gdmFsdWUucmVwbGFjZSgvXCsvZywgJyAnKTsKICAgIGVuY29kZWRVUkkgPSBlbmNvZGVkVVJJLnJlcGxhY2UoL1wlM0QvZywgJz0nKTsKCiAgICAvLyBUcnkgdGhlIGJ1aWx0IGluIGRlY29kZXIgZmlyc3QKICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoZW5jb2RlZFVSSSk7CiAgICAvLyAgICAgIHJldHVybiBkZWNvZGVDb21wb25lbnQodmFsdWUpOwp9CgpmdW5jdGlvbiBzcGxpdE9uRmlyc3Qoc3RyaW5nLCBzZXBhcmF0b3IpIHsKICAgIGlmICghKHR5cGVvZiBzdHJpbmcgPT09ICdzdHJpbmcnICYmIHR5cGVvZiBzZXBhcmF0b3IgPT09ICdzdHJpbmcnKSkgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIHRoZSBhcmd1bWVudHMgdG8gYmUgb2YgdHlwZSBgc3RyaW5nYCcpOwogICAgfQoKICAgIGlmIChzdHJpbmcgPT09ICcnIHx8IHNlcGFyYXRvciA9PT0gJycpIHsKICAgICAgICByZXR1cm4gW107CiAgICB9CgogICAgY29uc3Qgc2VwYXJhdG9ySW5kZXggPSBzdHJpbmcuaW5kZXhPZihzZXBhcmF0b3IpOwoKICAgIGlmIChzZXBhcmF0b3JJbmRleCA9PT0gLTEpIHsKICAgICAgICByZXR1cm4gW107CiAgICB9CgogICAgcmV0dXJuIFsKICAgICAgICBzdHJpbmcuc2xpY2UoMCwgc2VwYXJhdG9ySW5kZXgpLAogICAgICAgIHN0cmluZy5zbGljZShzZXBhcmF0b3JJbmRleCArIHNlcGFyYXRvci5sZW5ndGgpCiAgICBdOwp9CgoKZnVuY3Rpb24gcGFyc2VWYWx1ZSh2YWx1ZSkgewogICAgaWYgKCFOdW1iZXIuaXNOYU4oTnVtYmVyKHZhbHVlKSkgJiYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUudHJpbSgpICE9PSAnJykpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcih2YWx1ZSk7CiAgICB9IGVsc2UgaWYgKHZhbHVlICE9PSBudWxsICYmICh2YWx1ZS50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZScgfHwgdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gJ2ZhbHNlJykpIHsKICAgICAgICB2YWx1ZSA9IHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJzsKICAgIH0KCiAgICByZXR1cm4gdmFsdWU7Cn0KCgpmdW5jdGlvbiBwYXJzZXJGb3JBcnJheUZvcm1hdCgpIHsKICAgIHJldHVybiAoa2V5LCB2YWx1ZSwgYWNjdW11bGF0b3IpID0+IHsKICAgICAgICBpZiAoYWNjdW11bGF0b3Jba2V5XSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGFjY3VtdWxhdG9yW2tleV0gPSB2YWx1ZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgYWNjdW11bGF0b3Jba2V5XSA9IFtdLmNvbmNhdChhY2N1bXVsYXRvcltrZXldLCB2YWx1ZSk7CiAgICB9Owp9CgpmdW5jdGlvbiBwaW5jaChib2R5LCBzdGFydCwgZW5kLCBzbmlwLCBlbmlwLCBlbXB0eSwgdHJ1bmNhdGUpIHsKICAgIGxldCBleHRyYWN0ID0gZW1wdHk7CiAgICBsZXQgc3BvcyA9IGJvZHkuaW5kZXhPZihzdGFydCk7CiAgICBsZXQgc2xlbiA9IHN0YXJ0Lmxlbmd0aDsKICAgIGlmIChzcG9zID49IDApIHsKICAgICAgICBsZXQgbmV4dCA9IGJvZHkuc3Vic3RyKHNwb3MgKyBzbGVuIC0gc25pcCk7CiAgICAgICAgbGV0IGVwb3MgPSBuZXh0LmluZGV4T2YoZW5kKTsKICAgICAgICBpZiAoZXBvcyA+PSAwKSB7CiAgICAgICAgICAgIGV4dHJhY3QgPSBuZXh0LnN1YnN0cigwLCBlcG9zICsgZW5pcCk7CiAgICAgICAgICAgIGlmICh0cnVuY2F0ZSkgYm9keSA9IGJvZHkuc3Vic3RyKHNwb3MgKyBzbGVuIC0gc25pcCArIGVwb3MgKyBlbmlwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBleHRyYWN0ID0gYm9keS5zdWJzdHIoc3BvcyArIHNsZW4gLSBzbmlwKTsKICAgICAgICAgICAgaWYgKHRydW5jYXRlKSBib2R5ID0gJyc7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBpZiAodHJ1bmNhdGUpIGJvZHkgPSAnJzsKICAgIH0KICAgIHJldHVybiBleHRyYWN0Owp9CgpmdW5jdGlvbiBibG9jayhib2R5LCBzdGFydCwgc25pcCwgb3BlbiwgY2xvc2UsIGVtcHR5LCB0cnVuY2F0ZSkgewogICAgbGV0IGV4dHJhY3QgPSBlbXB0eTsKICAgIGxldCBzcG9zID0gYm9keS5pbmRleE9mKHN0YXJ0KTsKICAgIGxldCBzbGVuID0gc3RhcnQubGVuZ3RoOwogICAgaWYgKHNwb3MgPj0gMCkgewogICAgICAgIGxldCBwb3MgPSBzcG9zICsgc2xlbiAtIHNuaXA7CiAgICAgICAgbGV0IGRvbmUgPSBmYWxzZTsKICAgICAgICBsZXQgbGV2ZWwgPSAwOwogICAgICAgIGV4dHJhY3QgPSBzdGFydC5zdWJzdHIoMCwgc2xlbiAtIHNuaXApOwogICAgICAgIHdoaWxlICghZG9uZSkgewogICAgICAgICAgICBzd2l0Y2ggKGJvZHlbcG9zXSkgewogICAgICAgICAgICAgICAgY2FzZSBvcGVuOgogICAgICAgICAgICAgICAgICAgIGxldmVsKys7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIGNsb3NlOgogICAgICAgICAgICAgICAgICAgIGxldmVsLS07CiAgICAgICAgICAgICAgICAgICAgaWYgKCFsZXZlbCkgZG9uZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZXh0cmFjdCArPSBib2R5W3Bvc107CiAgICAgICAgICAgIHBvcysrOwogICAgICAgICAgICBpZiAocG9zID49IGJvZHkubGVuZ3RoKSBkb25lID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKHRydW5jYXRlKSBib2R5ID0gYm9keS5zdWJzdHJpbmcoMCwgcG9zKTsKICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRydW5jYXRlKSBib2R5ID0gJyc7CiAgICB9CiAgICByZXR1cm4gZXh0cmFjdDsKfQoKZnVuY3Rpb24gZ2V0bihib2R5KSB7CiAgICBsZXQgZm5hbWUgPSAiaWhhIi8vcGluY2goYm9keSwgJyYmKGI9YS5nZXQoIm4iKSkmJihiPScsICcoYiknLCAwLCAwLCAnJywgZmFsc2UpOwogICAgbGV0IGZmdW5jID0gZm5hbWUgKyAnPWZ1bmN0aW9uKGEpJzsKICAgIGZmdW5jID0gJ3ZhciAnICsgYmxvY2soYm9keSwgZmZ1bmMsIDAsICd7JywgJ30nLCAne30nLCBmYWxzZSk7CiAgICBuY29kZUZuID0gbmV3IEZ1bmN0aW9uKCduY29kZScsIGZmdW5jICsgJzsgcmV0dXJuICcgKyBmbmFtZSArICcobmNvZGUpOycpOwp9",
  "javascript_upNext": "Y29uc3QgQkFTRV9VUkwgPSAnaHR0cHM6Ly93d3cueW91dHViZS5jb20nOwoKZnVuY3Rpb24gZ2V0dXJsKGlkKSB7CiAgICByZXR1cm4gewogICAgICAgIHVybDogYCR7QkFTRV9VUkx9L3dhdGNoP3Y9JHtpZH0mYXBwPWRlc2t0b3BgLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTVfNikgQXBwbGVXZWJLaXQvNjA1LjEuMTUgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzE0LjAuMyBTYWZhcmkvNjA1LjEuMTUnCiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBnZXRXYXRjaEhUTUxQYWdlKGJvZHkpIHsKICAgIGxldCBkYXRhID0gZmluZEpTT04oJ25leHQuaHRtbCcsICduZXh0X3Jlc3BvbnNlJywgYm9keSwgL1xieXRJbml0aWFsRGF0YVxzKj1ccyp7LywgJzwvc2NyaXB0PicsICd7Jyk7CiAgICByZXR1cm4gbmV4dFZpZGVvcyhkYXRhKQp9OwoKZnVuY3Rpb24gbmV4dFZpZGVvcyhkYXRhKSB7CiAgICB2YXIgY29udGVudHMKICAgIHRyeSB7CiAgICAgIGNvbnRlbnRzID0gZGF0YS5wbGF5ZXJPdmVybGF5cy5wbGF5ZXJPdmVybGF5UmVuZGVyZXIuZW5kU2NyZWVuLndhdGNoTmV4dEVuZFNjcmVlblJlbmRlcmVyLnJlc3VsdHM7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjb250ZW50cyA9IGRhdGEuY29udGVudHMudHdvQ29sdW1uV2F0Y2hOZXh0UmVzdWx0cy5zZWNvbmRhcnlSZXN1bHRzLnNlY29uZGFyeVJlc3VsdHMucmVzdWx0cwogICAgfQogICAgCiAgICB2YXIgcmVzdWx0ID0gW10KCiAgICBjb250ZW50cy5mb3JFYWNoKGNvbnRlbnQgPT4gewogICAgICAgICAgbGV0IHZpZGVvID0gdG9WaWRlbyhjb250ZW50KQogICAgICAgICAgaWYgKHZpZGVvKSB7CiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHZpZGVvKQogICAgICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0Cn0KCmZ1bmN0aW9uIHRvVmlkZW8oaXRlbSkgewogICAgdHJ5IHsKICAgICAgdmFyIHZpZGVvUmVuZGVyZXIgPSBpdGVtLmVuZFNjcmVlblZpZGVvUmVuZGVyZXIKICAgICAgaWYgKHZpZGVvUmVuZGVyZXIgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHZpZGVvUmVuZGVyZXIgPSBpdGVtLmNvbXBhY3RWaWRlb1JlbmRlcmVyCiAgICAgIH0KICAgICAgY29uc3QgewogICAgICAgIHRpdGxlLAogICAgICAgIHNob3J0QnlsaW5lVGV4dDogeyBydW5zIH0sCiAgICAgICAgdGh1bWJuYWlsLAogICAgICAgIHZpZGVvSWQsCiAgICAgICAgbGVuZ3RoVGV4dDogeyBzaW1wbGVUZXh0OiB0aW1lIH0KICAgICAgfSA9IHZpZGVvUmVuZGVyZXI7CiAgCiAgICAgIHJldHVybiB7CiAgICAgICAgdHlwZTogMCwKICAgICAgICB0aXRsZTogdGl0bGUuc2ltcGxlVGV4dCwKICAgICAgICBkZXNjcmlwdGlvbjogcnVuc1swXSA/IHJ1bnNbMF0udGV4dCA6ICIiLAogICAgICAgIGltYWdlOiB0aHVtYm5haWwudGh1bWJuYWlscy5zbGljZSgtMSlbMF0udXJsLAogICAgICAgIHZpZGVvSWQsCiAgICAgICAgdGltZTogdGltZQogICAgICB9OwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5sb2coInRvVmlkZW8iLCBlcnJvcikKICAgICAgcmV0dXJuIG51bGwKICAgIH0KICB9CgpmdW5jdGlvbiBmaW5kSlNPTihzb3VyY2UsIHZhck5hbWUsIGJvZHksIGxlZnQsIHJpZ2h0LCBwcmVwZW5kSlNPTikgewogICAgbGV0IGpzb25TdHIgPSBiZXR3ZWVuKGJvZHksIGxlZnQsIHJpZ2h0KTsKICAgIGlmICghanNvblN0cikgewogICAgICB0aHJvdyBFcnJvcihgQ291bGQgbm90IGZpbmQgJHt2YXJOYW1lfSBpbiAke3NvdXJjZX1gKTsKICAgIH0KICAgIHJldHVybiBwYXJzZUpTT04oc291cmNlLCB2YXJOYW1lLCBjdXRBZnRlckpTT04oYCR7cHJlcGVuZEpTT059JHtqc29uU3RyfWApKTsKICB9OwogIAogIGJldHdlZW4gPSAoaGF5c3RhY2ssIGxlZnQsIHJpZ2h0KSA9PiB7CiAgICBsZXQgcG9zOwogICAgaWYgKGxlZnQgaW5zdGFuY2VvZiBSZWdFeHApIHsKICAgICAgY29uc3QgbWF0Y2ggPSBoYXlzdGFjay5tYXRjaChsZWZ0KTsKICAgICAgaWYgKCFtYXRjaCkgeyByZXR1cm4gJyc7IH0KICAgICAgcG9zID0gbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGg7CiAgICB9IGVsc2UgewogICAgICBwb3MgPSBoYXlzdGFjay5pbmRleE9mKGxlZnQpOwogICAgICBpZiAocG9zID09PSAtMSkgeyByZXR1cm4gJyc7IH0KICAgICAgcG9zICs9IGxlZnQubGVuZ3RoOwogICAgfQogICAgaGF5c3RhY2sgPSBoYXlzdGFjay5zbGljZShwb3MpOwogICAgcG9zID0gaGF5c3RhY2suaW5kZXhPZihyaWdodCk7CiAgICBpZiAocG9zID09PSAtMSkgeyByZXR1cm4gJyc7IH0KICAgIGhheXN0YWNrID0gaGF5c3RhY2suc2xpY2UoMCwgcG9zKTsKICAgIHJldHVybiBoYXlzdGFjazsKICB9OwogIAogIGN1dEFmdGVySlNPTiA9IG1peGVkSnNvbiA9PiB7CiAgICBsZXQgb3BlbiwgY2xvc2U7CiAgICBpZiAobWl4ZWRKc29uWzBdID09PSAnWycpIHsKICAgICAgb3BlbiA9ICdbJzsKICAgICAgY2xvc2UgPSAnXSc7CiAgICB9IGVsc2UgaWYgKG1peGVkSnNvblswXSA9PT0gJ3snKSB7CiAgICAgIG9wZW4gPSAneyc7CiAgICAgIGNsb3NlID0gJ30nOwogICAgfQogIAogICAgaWYgKCFvcGVuKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgQ2FuJ3QgY3V0IHVuc3VwcG9ydGVkIEpTT04gKG5lZWQgdG8gYmVnaW4gd2l0aCBbIG9yIHsgKSBidXQgZ290OiAke21peGVkSnNvblswXX1gKTsKICAgIH0KICAKICAgIC8vIFN0YXRlcyBpZiB0aGUgbG9vcCBpcyBjdXJyZW50bHkgaW4gYSBzdHJpbmcKICAgIGxldCBpc1N0cmluZyA9IGZhbHNlOwogIAogICAgLy8gU3RhdGVzIGlmIHRoZSBjdXJyZW50IGNoYXJhY3RlciBpcyB0cmVhdGVkIGFzIGVzY2FwZWQgb3Igbm90CiAgICBsZXQgaXNFc2NhcGVkID0gZmFsc2U7CiAgCiAgICAvLyBDdXJyZW50IG9wZW4gYnJhY2tldHMgdG8gYmUgY2xvc2VkCiAgICBsZXQgY291bnRlciA9IDA7CiAgCiAgICBsZXQgaTsKICAgIGZvciAoaSA9IDA7IGkgPCBtaXhlZEpzb24ubGVuZ3RoOyBpKyspIHsKICAgICAgLy8gVG9nZ2xlIHRoZSBpc1N0cmluZyBib29sZWFuIHdoZW4gbGVhdmluZy9lbnRlcmluZyBzdHJpbmcKICAgICAgaWYgKG1peGVkSnNvbltpXSA9PT0gJyInICYmICFpc0VzY2FwZWQpIHsKICAgICAgICBpc1N0cmluZyA9ICFpc1N0cmluZzsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogIAogICAgICAvLyBUb2dnbGUgdGhlIGlzRXNjYXBlZCBib29sZWFuIGZvciBldmVyeSBiYWNrc2xhc2gKICAgICAgLy8gUmVzZXQgZm9yIGV2ZXJ5IHJlZ3VsYXIgY2hhcmFjdGVyCiAgICAgIGlzRXNjYXBlZCA9IG1peGVkSnNvbltpXSA9PT0gJ1xcJyAmJiAhaXNFc2NhcGVkOwogIAogICAgICBpZiAoaXNTdHJpbmcpIGNvbnRpbnVlOwogIAogICAgICBpZiAobWl4ZWRKc29uW2ldID09PSBvcGVuKSB7CiAgICAgICAgY291bnRlcisrOwogICAgICB9IGVsc2UgaWYgKG1peGVkSnNvbltpXSA9PT0gY2xvc2UpIHsKICAgICAgICBjb3VudGVyLS07CiAgICAgIH0KICAKICAgICAgLy8gQWxsIGJyYWNrZXRzIGhhdmUgYmVlbiBjbG9zZWQsIHRodXMgZW5kIG9mIEpTT04gaXMgcmVhY2hlZAogICAgICBpZiAoY291bnRlciA9PT0gMCkgewogICAgICAgIC8vIFJldHVybiB0aGUgY3V0IEpTT04KICAgICAgICByZXR1cm4gbWl4ZWRKc29uLnN1YnN0cigwLCBpICsgMSk7CiAgICAgIH0KICAgIH0KICAKICAgIC8vIFdlIHJhbiB0aHJvdWdoIHRoZSB3aG9sZSBzdHJpbmcgYW5kIGVuZGVkIHVwIHdpdGggYW4gdW5jbG9zZWQgYnJhY2tldAogICAgdGhyb3cgRXJyb3IoIkNhbid0IGN1dCB1bnN1cHBvcnRlZCBKU09OIChubyBtYXRjaGluZyBjbG9zaW5nIGJyYWNrZXQgZm91bmQpIik7CiAgfTsKICAKICBjb25zdCBqc29uQ2xvc2luZ0NoYXJzID0gL15bKVxdfSdcc10rLzsKICBmdW5jdGlvbiBwYXJzZUpTT04oc291cmNlLCB2YXJOYW1lLCBqc29uKSB7CiAgICBpZiAoIWpzb24gfHwgdHlwZW9mIGpzb24gPT09ICdvYmplY3QnKSB7CiAgICAgIHJldHVybiBqc29uOwogICAgfSBlbHNlIHsKICAgICAgdHJ5IHsKICAgICAgICBqc29uID0ganNvbi5yZXBsYWNlKGpzb25DbG9zaW5nQ2hhcnMsICcnKTsKICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhyb3cgRXJyb3IoYEVycm9yIHBhcnNpbmcgJHt2YXJOYW1lfSBpbiAke3NvdXJjZX06ICR7ZXJyLm1lc3NhZ2V9YCk7CiAgICAgIH0KICAgIH0KICB9Owo=",
  "javascript_search": "Y29uc3QgQkFTRV9VUkwgPSAnaHR0cHM6Ly9tLnlvdXR1YmUuY29tJzsKCnZhciBnbCA9ICJVUyIKdmFyIGhsID0gImVuIgoKZnVuY3Rpb24gZ2V0dXJsKGtleSwgdHlwZSkgewogICAgY29uc3QgaWQgPSBlbmNvZGVVUkkoa2V5KQogICAgbGV0IHVybAogICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAvL3ZpZGVvcwogICAgICAgICAgICB1cmwgPSBgJHtCQVNFX1VSTH0vcmVzdWx0cz9zZWFyY2hfcXVlcnk9JHtpZH0mYXBwPWRlc2t0b3Amc3A9RWdJUUFRJTI1M0QlMjUzRGAKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAvL3BsYXlsaXN0CiAgICAgICAgICAgIHVybCA9IGAke0JBU0VfVVJMfS9yZXN1bHRzP3NlYXJjaF9xdWVyeT0ke2lkfSZhcHA9ZGVza3RvcCZzcD1FZ0lRQXclMjUzRCUyNTNEYAogICAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgdXJsID0gYCR7QkFTRV9VUkx9L3Jlc3VsdHM/c2VhcmNoX3F1ZXJ5PSR7aWR9JmFwcD1kZXNrdG9wYAogICAgICAgICAgICBicmVhazsKICAgIH0KICAgIHJldHVybiB7CiAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoaVBob25lOyBDUFUgaVBob25lIE9TIDEzXzFfMyBsaWtlIE1hYyBPUyBYKSBBcHBsZVdlYktpdC82MDUuMS4xNSAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vMTMuMC4xIE1vYmlsZS8xNUUxNDggU2FmYXJpLzYwNC4xJwogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gcG9zdE1vcmUoKSB7CiAgICByZXR1cm4gewogICAgICAgIHVybDogYCR7QkFTRV9VUkx9L3lvdXR1YmVpL3YxL3NlYXJjaD9rZXk9QUl6YVN5QU9fRkoyU2xxVThRNFNURUhMR0NpbHdfWTlfMTFxY1c4YCwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChpUGhvbmU7IENQVSBpUGhvbmUgT1MgMTNfMV8zIGxpa2UgTWFjIE9TIFgpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8xMy4wLjEgTW9iaWxlLzE1RTE0OCBTYWZhcmkvNjA0LjEnLAogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iCiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBnZXRTZWFyY2hIVE1MUGFnZShib2R5LCBfZ2wsIF9obCkgewogICAgaWYgKF9nbCkgewogICAgICAgIGdsID0gX2dsLnRvVXBwZXJDYXNlKCkKICAgIH0KICAgIGlmIChfaGwpIHsKICAgICAgICBobCA9IF9obC50b0xvd2VyQ2FzZSgpCiAgICB9CiAgICBsZXQgZGF0YSA9IGZpbmRKU09OKCdzZWFyY2guaHRtbCcsICdzZWFyY2hfcmVzcG9uc2UnLCBib2R5LCAvXGJ5dEluaXRpYWxEYXRhXHMqPVxzKnsvLCAnPC9zY3JpcHQ+JywgJ3snKTsKICAgIHJldHVybiBnZXRTZWFyY2hKc29uKGRhdGEpCn0KCmZ1bmN0aW9uIGdldFNlYXJjaE1vcmVQYWdlKGJvZHkpIHsKICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShib2R5KTsKICAgIHJldHVybiBnZXRTZWFyY2hKc29uKGRhdGEpCn0KCgpmdW5jdGlvbiBmaW5kSlNPTihzb3VyY2UsIHZhck5hbWUsIGJvZHksIGxlZnQsIHJpZ2h0LCBwcmVwZW5kSlNPTikgewogICAgbGV0IGpzb25TdHIgPSBiZXR3ZWVuKGJvZHksIGxlZnQsIHJpZ2h0KTsKICAgIGlmICghanNvblN0cikgewogICAgICAgIHRocm93IEVycm9yKGBDb3VsZCBub3QgZmluZCAke3Zhck5hbWV9IGluICR7c291cmNlfWApOwogICAgfQogICAgbGV0IGN1dFN0cmluZyA9IGN1dEFmdGVySlNPTihgJHtwcmVwZW5kSlNPTn0ke2pzb25TdHJ9YCkKICAgIGlmICghY3V0U3RyaW5nKSB7CiAgICAgICAgdGhyb3cgRXJyb3IoYEN1dFN0cmluZyAke3Zhck5hbWV9IGluICR7c291cmNlfWApOwogICAgfQogICAgcmV0dXJuIEpTT04ucGFyc2UoY3V0U3RyaW5nKTsKICAgIC8vIHJldHVybiBwYXJzZUpTT04oc291cmNlLCB2YXJOYW1lLCBjdXRBZnRlckpTT04oYCR7cHJlcGVuZEpTT059JHtqc29uU3RyfWApKTsKfTsKCmJldHdlZW4gPSAoaGF5c3RhY2ssIGxlZnQsIHJpZ2h0KSA9PiB7CiAgICB0cnkgewogICAgICAgIGxldCBwb3M7CiAgICAgICAgaWYgKGxlZnQgaW5zdGFuY2VvZiBSZWdFeHApIHsKICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBoYXlzdGFjay5tYXRjaChsZWZ0KTsKICAgICAgICAgICAgaWYgKCFtYXRjaCkgeyByZXR1cm4gJyc7IH0KICAgICAgICAgICAgcG9zID0gbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGg7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcG9zID0gaGF5c3RhY2suaW5kZXhPZihsZWZ0KTsKICAgICAgICAgICAgaWYgKHBvcyA9PT0gLTEpIHsgcmV0dXJuICcnOyB9CiAgICAgICAgICAgIHBvcyArPSBsZWZ0Lmxlbmd0aDsKICAgICAgICB9CiAgICAgICAgaGF5c3RhY2sgPSBoYXlzdGFjay5zbGljZShwb3MpOwogICAgICAgIHBvcyA9IGhheXN0YWNrLmluZGV4T2YocmlnaHQpOwogICAgICAgIGlmIChwb3MgPT09IC0xKSB7IHJldHVybiAnJzsgfQogICAgICAgIGhheXN0YWNrID0gaGF5c3RhY2suc2xpY2UoMCwgcG9zKTsKICAgICAgICByZXR1cm4gaGF5c3RhY2s7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgYmV0d2VlbiA6ICR7ZXJyb3IubWVzc2FnZX1gKTsKICAgIH0KfTsKCmN1dEFmdGVySlNPTiA9IG1peGVkSnNvbiA9PiB7CiAgICB0cnkgewogICAgICAgIGxldCBvcGVuLCBjbG9zZTsKICAgICAgICBpZiAobWl4ZWRKc29uWzBdID09PSAnWycpIHsKICAgICAgICAgICAgb3BlbiA9ICdbJzsKICAgICAgICAgICAgY2xvc2UgPSAnXSc7CiAgICAgICAgfSBlbHNlIGlmIChtaXhlZEpzb25bMF0gPT09ICd7JykgewogICAgICAgICAgICBvcGVuID0gJ3snOwogICAgICAgICAgICBjbG9zZSA9ICd9JzsKICAgICAgICB9CgogICAgICAgIGlmICghb3BlbikgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbid0IGN1dCB1bnN1cHBvcnRlZCBKU09OIChuZWVkIHRvIGJlZ2luIHdpdGggWyBvciB7ICkgYnV0IGdvdDogJHttaXhlZEpzb25bMF19YCk7CiAgICAgICAgfQoKICAgICAgICAvLyBTdGF0ZXMgaWYgdGhlIGxvb3AgaXMgY3VycmVudGx5IGluIGEgc3RyaW5nCiAgICAgICAgbGV0IGlzU3RyaW5nID0gZmFsc2U7CgogICAgICAgIC8vIFN0YXRlcyBpZiB0aGUgY3VycmVudCBjaGFyYWN0ZXIgaXMgdHJlYXRlZCBhcyBlc2NhcGVkIG9yIG5vdAogICAgICAgIGxldCBpc0VzY2FwZWQgPSBmYWxzZTsKCiAgICAgICAgLy8gQ3VycmVudCBvcGVuIGJyYWNrZXRzIHRvIGJlIGNsb3NlZAogICAgICAgIGxldCBjb3VudGVyID0gMDsKCiAgICAgICAgbGV0IGk7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IG1peGVkSnNvbi5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAvLyBUb2dnbGUgdGhlIGlzU3RyaW5nIGJvb2xlYW4gd2hlbiBsZWF2aW5nL2VudGVyaW5nIHN0cmluZwogICAgICAgICAgICBpZiAobWl4ZWRKc29uW2ldID09PSAnIicgJiYgIWlzRXNjYXBlZCkgewogICAgICAgICAgICAgICAgaXNTdHJpbmcgPSAhaXNTdHJpbmc7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gVG9nZ2xlIHRoZSBpc0VzY2FwZWQgYm9vbGVhbiBmb3IgZXZlcnkgYmFja3NsYXNoCiAgICAgICAgICAgIC8vIFJlc2V0IGZvciBldmVyeSByZWd1bGFyIGNoYXJhY3RlcgogICAgICAgICAgICBpc0VzY2FwZWQgPSBtaXhlZEpzb25baV0gPT09ICdcXCcgJiYgIWlzRXNjYXBlZDsKCiAgICAgICAgICAgIGlmIChpc1N0cmluZykgY29udGludWU7CgogICAgICAgICAgICBpZiAobWl4ZWRKc29uW2ldID09PSBvcGVuKSB7CiAgICAgICAgICAgICAgICBjb3VudGVyKys7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobWl4ZWRKc29uW2ldID09PSBjbG9zZSkgewogICAgICAgICAgICAgICAgY291bnRlci0tOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBBbGwgYnJhY2tldHMgaGF2ZSBiZWVuIGNsb3NlZCwgdGh1cyBlbmQgb2YgSlNPTiBpcyByZWFjaGVkCiAgICAgICAgICAgIGlmIChjb3VudGVyID09PSAwKSB7CiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gdGhlIGN1dCBKU09OCiAgICAgICAgICAgICAgICByZXR1cm4gbWl4ZWRKc29uLnN1YnN0cigwLCBpICsgMSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFdlIHJhbiB0aHJvdWdoIHRoZSB3aG9sZSBzdHJpbmcgYW5kIGVuZGVkIHVwIHdpdGggYW4gdW5jbG9zZWQgYnJhY2tldAogICAgICAgIHRocm93IEVycm9yKCJDYW4ndCBjdXQgdW5zdXBwb3J0ZWQgSlNPTiAobm8gbWF0Y2hpbmcgY2xvc2luZyBicmFja2V0IGZvdW5kKSIpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGN1dEFmdGVySlNPTiA6ICR7ZXJyb3IubWVzc2FnZX1gKTsKICAgIH0KfTsKCmNvbnN0IGpzb25DbG9zaW5nQ2hhcnMgPSAvXlspXF19J1xzXSsvOwpmdW5jdGlvbiBwYXJzZUpTT04oc291cmNlLCB2YXJOYW1lLCBqc29uKSB7CiAgICBpZiAoIWpzb24gfHwgdHlwZW9mIGpzb24gPT09ICdvYmplY3QnKSB7CiAgICAgICAgcmV0dXJuIGpzb247CiAgICB9IGVsc2UgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGpzb24gPSBqc29uLnJlcGxhY2UoanNvbkNsb3NpbmdDaGFycywgJycpOwogICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgdGhyb3cgRXJyb3IoYEVycm9yIHBhcnNpbmcgJHt2YXJOYW1lfSBpbiAke3NvdXJjZX06ICR7ZXJyLm1lc3NhZ2V9YCk7CiAgICAgICAgfQogICAgfQp9OwoKZnVuY3Rpb24gZ2V0U2VhcmNoSnNvbihkYXRhKSB7CiAgICB2YXIgY29udGVudHMKICAgIGlmIChkYXRhLmNvbnRlbnRzKSB7CiAgICAgICAgY29udGVudHMgPSBkYXRhLmNvbnRlbnRzLnR3b0NvbHVtblNlYXJjaFJlc3VsdHNSZW5kZXJlci5wcmltYXJ5Q29udGVudHMKICAgICAgICAgICAgLnNlY3Rpb25MaXN0UmVuZGVyZXIuY29udGVudHM7CiAgICB9IGVsc2UgewogICAgICAgIGNvbnRlbnRzID0gZGF0YS5vblJlc3BvbnNlUmVjZWl2ZWRDb21tYW5kc1swXS5hcHBlbmRDb250aW51YXRpb25JdGVtc0FjdGlvbi5jb250aW51YXRpb25JdGVtczsKICAgIH0KCiAgICB2YXIgcmVzdWx0ID0gW10KICAgIHZhciBjb250aW51YXRpb24gPSAiIgoKICAgIGNvbnRlbnRzLmZvckVhY2goY29udGVudCA9PiB7CiAgICAgICAgY29uc3QgaXRlbVNlY3Rpb25SZW5kZXJlciA9IGNvbnRlbnQuaXRlbVNlY3Rpb25SZW5kZXJlcgogICAgICAgIGlmIChpdGVtU2VjdGlvblJlbmRlcmVyKSB7CiAgICAgICAgICAgIGl0ZW1TZWN0aW9uUmVuZGVyZXIuY29udGVudHMuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgICAgICAgIGxldCB2aWRlbyA9IHRvVmlkZW8oaXRlbSkKICAgICAgICAgICAgICAgIGlmICh2aWRlbykgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJhZGQgVmlkZW8iKQogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHZpZGVvKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBsZXQgcGwgPSB0b1BsYXlsaXN0KGl0ZW0pCiAgICAgICAgICAgICAgICAgICAgaWYgKHBsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJhZGQgUGxheWxpc3QiKQogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChwbCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChjb250ZW50LmNvbnRpbnVhdGlvbkl0ZW1SZW5kZXJlcikgewogICAgICAgICAgICAgICAgY29udGludWF0aW9uID0gY29udGVudC5jb250aW51YXRpb25JdGVtUmVuZGVyZXIuY29udGludWF0aW9uRW5kcG9pbnQuY29udGludWF0aW9uQ29tbWFuZC50b2tlbgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSk7CgogICAgY29uc3QganNvbkRhdGEgPSB7CiAgICAgICAgcmVzdWx0czogcmVzdWx0LAogICAgICAgIGNvdW50OiByZXN1bHQubGVuZ3RoLAogICAgICAgIHRva2VuOiB7CiAgICAgICAgICAgICJjb250ZXh0IjogewogICAgICAgICAgICAgICAgImNsaWVudCI6IHsKICAgICAgICAgICAgICAgICAgICAiaGwiOiBobCwKICAgICAgICAgICAgICAgICAgICAiZ2wiOiBnbCwKICAgICAgICAgICAgICAgICAgICAicmVtb3RlSG9zdCI6ICIiLAogICAgICAgICAgICAgICAgICAgICJkZXZpY2VNYWtlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgImRldmljZU1vZGVsIjogIiIsCiAgICAgICAgICAgICAgICAgICAgInZpc2l0b3JEYXRhIjogIiIsCiAgICAgICAgICAgICAgICAgICAgInVzZXJBZ2VudCI6ICJNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxMF8xNV82KSBBcHBsZVdlYktpdC82MDUuMS4xNSAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vMTQuMC4zIFNhZmFyaS82MDUuMS4xNSIsCiAgICAgICAgICAgICAgICAgICAgImNsaWVudE5hbWUiOiAiV0VCIiwKICAgICAgICAgICAgICAgICAgICAiY2xpZW50VmVyc2lvbiI6ICIyLjIwMjEwNzIxLjAwLjAwIiwKICAgICAgICAgICAgICAgICAgICAib3NOYW1lIjogIldpbmRvd3MiLAogICAgICAgICAgICAgICAgICAgICJvc1ZlcnNpb24iOiAiMTAuMCIsCiAgICAgICAgICAgICAgICAgICAgIm9yaWdpbmFsVXJsIjogIiIsCiAgICAgICAgICAgICAgICAgICAgInBsYXRmb3JtIjogIkRFU0tUT1AiLAogICAgICAgICAgICAgICAgICAgICJjbGllbnRGb3JtRmFjdG9yIjogIlVOS05PV05fRk9STV9GQUNUT1IiLAogICAgICAgICAgICAgICAgICAgICJicm93c2VyTmFtZSI6ICJDaHJvbWUiLAogICAgICAgICAgICAgICAgICAgICJicm93c2VyVmVyc2lvbiI6ICI3NC4wLjM3MjkuMTY5IgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJ1c2VyIjogewogICAgICAgICAgICAgICAgICAgICJsb2NrZWRTYWZldHlNb2RlIjogImZhbHNlIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJyZXF1ZXN0IjogewogICAgICAgICAgICAgICAgICAgICJ1c2VTc2wiOiAidHJ1ZSIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAiY2xpY2tUcmFja2luZyI6IHsKICAgICAgICAgICAgICAgICAgICAiY2xpY2tUcmFja2luZ1BhcmFtcyI6ICJJaE1JdW9DaW5yYUE4Z0lWbEovQ0NoMzlmd3BTIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICAiY29udGludWF0aW9uIjogY29udGludWF0aW9uCiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIGpzb25EYXRhCn0KCgpmdW5jdGlvbiB0b1ZpZGVvKGl0ZW0pIHsKICAgIHRyeSB7CiAgICAgICAgdmFyIHZpZGVvUmVuZGVyZXIgPSBpdGVtLnZpZGVvUmVuZGVyZXIKICAgICAgICBpZiAodmlkZW9SZW5kZXJlciA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsCiAgICAgICAgfQogICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgdGl0bGUsCiAgICAgICAgICAgIGxvbmdCeWxpbmVUZXh0OiB7IHJ1bnMgfSwKICAgICAgICAgICAgdGh1bWJuYWlsLAogICAgICAgICAgICB2aWRlb0lkLAogICAgICAgICAgICBsZW5ndGhUZXh0OiB7IHNpbXBsZVRleHQ6IHRpbWUgfQogICAgICAgIH0gPSB2aWRlb1JlbmRlcmVyOwoKICAgICAgICByZXR1cm4gewogICAgICAgICAgICB0eXBlOiAwLAogICAgICAgICAgICB0aXRsZTogdGl0bGUucnVuc1swXS50ZXh0LAogICAgICAgICAgICBkZXNjcmlwdGlvbjogcnVuc1swXSA/IHJ1bnNbMF0udGV4dCA6ICIiLAogICAgICAgICAgICBpbWFnZTogdGh1bWJuYWlsLnRodW1ibmFpbHMuc2xpY2UoLTEpWzBdLnVybCwKICAgICAgICAgICAgdmlkZW9JZCwKICAgICAgICAgICAgdGltZTogdGltZQogICAgICAgIH07CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKCJ0b1ZpZGVvIiwgZXJyb3IpCiAgICAgICAgcmV0dXJuIG51bGwKICAgIH0KfQoKZnVuY3Rpb24gdG9QbGF5bGlzdChpdGVtKSB7CiAgICB0cnkgewogICAgICAgIHZhciBwbCA9IGl0ZW0ucGxheWxpc3RSZW5kZXJlcgogICAgICAgIGlmIChwbCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsCiAgICAgICAgfQogICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgdGl0bGUsCiAgICAgICAgICAgIHZpZGVvQ291bnRUZXh0LAogICAgICAgICAgICB0aHVtYm5haWxzLAogICAgICAgICAgICB0aHVtYm5haWwsCiAgICAgICAgICAgIHBsYXlsaXN0SWQsCiAgICAgICAgICAgIHZpZGVvQ291bnRTaG9ydFRleHQsCiAgICAgICAgICAgIGxvbmdCeWxpbmVUZXh0CiAgICAgICAgfSA9IHBsOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHR5cGU6IDEsCiAgICAgICAgICAgIHRpdGxlOiB0aXRsZS5zaW1wbGVUZXh0LAogICAgICAgICAgICBpbWFnZTogdGh1bWJuYWlscyA/IHRodW1ibmFpbHNbMF0udGh1bWJuYWlscy5zbGljZSgtMSlbMF0udXJsIDogdGh1bWJuYWlsLnRodW1ibmFpbHMuc2xpY2UoLTEpWzBdLnVybCwKICAgICAgICAgICAgcGxheWxpc3RJZCwKICAgICAgICAgICAgY291bnQ6IHZpZGVvQ291bnRTaG9ydFRleHQgPyB2aWRlb0NvdW50U2hvcnRUZXh0LnJ1bnNbMF0udGV4dCA6IHZpZGVvQ291bnRUZXh0LnJ1bnNbMF0udGV4dCwKICAgICAgICAgICAgZGVzY3JpcHRpb246IGxvbmdCeWxpbmVUZXh0LnNpbXBsZVRleHQgPyBsb25nQnlsaW5lVGV4dC5zaW1wbGVUZXh0IDogbG9uZ0J5bGluZVRleHQucnVuc1swXS50ZXh0CiAgICAgICAgfTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coInRvUGxheWxpc3QiLCBlcnJvcikKICAgICAgICByZXR1cm4gbnVsbAogICAgfQp9Cg=="
}
